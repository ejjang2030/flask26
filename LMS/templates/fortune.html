{% extends "fortune_base.html" %}
{% block content %}
<style>
    /* ê³µì§€ì‚¬í•­ ë•Œ ì¼ë˜ ëŠë‚Œê³¼ ë¹„ìŠ·í•˜ê²Œ ê¹”ë”í•œ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
    .fortune-card { border-radius: 15px; border: none; }
    .btn-fortune { background-color: #8C7E7B; color: white; border: none; }
    .btn-fortune:hover { background-color: #6d6260; color: white; }
    .notice-row td { background-color: #f0f7f7 !important; }
    .badge-hot { background-color: #8C7E7B !important; color: white; }
</style>

<div class="container mt-5" style="max-width: 800px;">
    <h2 class="text-center mb-4">ğŸ’« ë ë³„ ìš´ì„¸ ğŸ’«</h2>

    <div class="card shadow-sm mb-5 fortune-card">
        <div class="card-body bg-light" style="border-radius: 15px;">
            <form method="POST" class="row g-3">
                <div class="col-md-4">
                    <label class="form-label fw-bold">ì¶œìƒ ì—°ë„</label>
                    <input type="number" name="year" class="form-control" placeholder="YYYY" min="1900" max="2026" required>
                </div>
                <div class="col-md-4">
                    <label class="form-label fw-bold">ì›”</label>
                    <input type="number" name="month" class="form-control" placeholder="MM" min="1" max="12" required>
                </div>
                <div class="col-md-4">
                    <label class="form-label fw-bold">ì¼</label>
                    <input type="number" name="day" class="form-control" placeholder="DD" min="1" max="31" required>
                </div>
                <div class="col-12 text-center mt-4">
                    <form method = "POST">
                    <button type="submit" class="btn btn-fortune px-5 py-2">ë‚´ ìš´ì„¸ í™•ì¸í•˜ê¸°</button>
                    </form>
                </div>
            </form>
        </div>
    </div>

    {% if data %}
    <div id="fortuneResult" class="animate__animated animate__fadeIn">
        <h3 class="text-center mb-4 text-secondary">âœ¨ {{ data.zodiac }} ìš´ì„¸ ê²°ê³¼</h3>

        <div class="table-responsive">
            <table class="table table-bordered shadow-sm align-middle">
                <tbody>
                    <tr class="text-center">
                        <th class="bg-light" style="width: 30%;">ì¶œìƒì¼ / ë‚˜ì´</th>
                        <td><strong>{{ data.birth }}</strong> (í˜„ì¬ {{ data.age }}ì„¸)</td>
                    </tr>
                    <tr>
                        <th class="text-center bg-light text-primary">ì˜¤ëŠ˜ì˜ ìš´ì„¸</th>
                        <td class="p-3">{{ data.today }}</td>
                    </tr>
                    <tr>
                        <th class="text-center bg-light text-danger">ë‚´ì¼ì˜ ìš´ì„¸</th>
                        <td class="p-3">{{ data.tomorrow }}</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <div class="d-flex justify-content-center gap-3 mt-4 mb-5">
            <button class="btn btn-outline-secondary px-4" onclick="copyLink()">
                ğŸ”— ë§í¬ ë³µì‚¬
            </button>
            <button class="btn btn-dark px-4" onclick="copyFortuneText()">
                ğŸ“ ê²°ê³¼ í…ìŠ¤íŠ¸ ë³µì‚¬
            </button>
        </div>
    </div>
    {% endif %}
</div>

<script>
// ë§í¬ ë³µì‚¬ í•¨ìˆ˜
function copyLink() {
    const url = window.location.href;
    navigator.clipboard.writeText(url).then(() => {
        alert("ìš´ì„¸ í˜ì´ì§€ ë§í¬ê°€ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹œêµ¬ë“¤ì—ê²Œ ì•Œë ¤ì£¼ì„¸ìš”.");
    });
}

// ê²°ê³¼ í…ìŠ¤íŠ¸ ë³µì‚¬ í•¨ìˆ˜
function copyFortuneText() {
    const zodiac = "{{ data.zodiac if data else '' }}";
    const today = "{{ data.today if data else '' }}";
    const tomorrow = "{{ data.tomorrow if data else '' }}";

    // ë³µì‚¬ë  í…ìŠ¤íŠ¸ í˜•ì‹ êµ¬ì„±
    const text = `[ğŸ”® ${zodiac} ìš´ì„¸ ê³µìœ ]\n\nğŸŒŸ ì˜¤ëŠ˜ì˜ ìš´ì„¸:\n${today}\n\nğŸŒ™ ë‚´ì¼ì˜ ìš´ì„¸:\n${tomorrow}\n\ní™•ì¸í•˜ëŸ¬ ê°€ê¸°: ${window.location.href}`;

    navigator.clipboard.writeText(text).then(() => {
        alert("ìš´ì„¸ ê²°ê³¼ê°€ í…ìŠ¤íŠ¸ë¡œ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤! ì¹´í†¡ ë“±ì— ë¶™ì—¬ë„£ê¸° í•˜ì„¸ìš”.");
    });
}
</script>
{% endblock %}